{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Mkdocs","text":"<p>Set of useful tips for developers who are using bash, git, mysql, etc.</p> <p>Install:</p> <ul> <li><code>python3 -m venv .venv</code> - install python virtual env</li> <li><code>source .venv/bin/activate</code> - activate virtual env</li> <li><code>pip install mkdocs</code> - install mkdocs (more info)</li> <li><code>pip install mkdocs-material</code> -  install material theme (more info)</li> <li>make sure the PATH is configured: <code>export PATH=\"$HOME/.local/bin:$PATH\"</code></li> </ul> <p>Upgrade:</p> <ul> <li><code>usr/bin/python3 -m pip install --upgrade pip</code> - upgrade python</li> <li><code>pip install --upgrade mkdocs</code> - upgrade mkdocs</li> <li><code>pip install --upgrade mkdocs-material</code> -  upgrade material theme (more info)</li> </ul> <p>Usage:</p> <ul> <li><code>mkdocs serve</code> - start HTTP server</li> <li><code>mkdocs gh-deploy</code> - deploy to github pages</li> <li>Markdown Cheatsheet</li> </ul>"},{"location":"composer/","title":"Composer","text":""},{"location":"composer/#install","title":"Install","text":"<pre><code>curl -sS https://getcomposer.org/installer | sudo php -- --install-dir=/usr/bin --filename=composer\n</code></pre>"},{"location":"composer/#add-a-custom-packages-repository","title":"Add a custom packages repository","text":"<pre><code>composer config --global repositories.example composer https://packages.example.com/\n</code></pre>"},{"location":"composer/#install-composer-package-from-a-local-folder","title":"Install composer package from a local folder","text":"<pre><code>mkdir -p ~/composer-packages/\ncp vendor-module-x.x.x.zip ~/composer-packages/\ncd ~/public_html/\ncomposer config repositories.local artifact ~/composer-packages/\ncomposer require vendor/module\n#or\ncomposer update vendor/module\n</code></pre>"},{"location":"disk/","title":"Disk","text":""},{"location":"disk/#write-iso-to-disk","title":"write iso to disk","text":"<p><pre><code>dd if=os.img of=/dev/sdX bs=1M status=progress oflag=dsync\n</code></pre> where - oflag=dsync - synchronize I/O for data.</p>"},{"location":"disk/#ram-disk","title":"RAM disk","text":"<pre><code>sudo mount -o size=2G -t tmpfs none my.project.com\n</code></pre>"},{"location":"disk/#mounted-filesystems-in-nice-layout","title":"Mounted filesystems in nice layout","text":"<pre><code>mount | column -t\n</code></pre>"},{"location":"disk/#create-windows-usb-flash","title":"Create Windows USB flash","text":"<ol> <li>Install WoeUSB</li> <li>Unmount flash drive using Disks program</li> <li>Write ISO <pre><code>bash woeusb-5.2.4.bash --device windows.iso /dev/sdc\n</code></pre></li> <li>Reboot and install Windows</li> </ol>"},{"location":"disk/#acl","title":"ACL","text":""},{"location":"disk/#full-access-for-two-users","title":"Full access for two users","text":"<pre><code>setfacl -R -d -m u:user1:rwx,u:user2:rwx .   # set default ACL for specific users\nsetfacl -R -m u:user1:rwx,u:user2:rwx .      # set ACL for specific users\nsetfacl -bn .                                # remove all extended ACL entries\nsetfacl -R -d -m g:media:rwx .               # default ACL for media group\nsetfacl -R -m g:media:rwx .                  # ACL for media group\ngetfacl .                                    # get file access control lists\n</code></pre>"},{"location":"disk/#check-read-only-file-systems","title":"Check read-only file systems","text":"<p><pre><code>grep \"[[:space:]]ro[[:space:],]\" /proc/mounts\n</code></pre> Source: serverfault.com</p>"},{"location":"disk/#groups","title":"Groups","text":"<pre><code>usermod -aG group_name user_name    # add group to user\nnewgrp group_name                   # activate the changes to groups\n</code></pre>"},{"location":"docker/","title":"Docker","text":""},{"location":"docker/#misc","title":"Misc","text":""},{"location":"docker/#remove-all-images-except-phpmyadmin","title":"Remove all images except phpmyadmin","text":"<pre><code>docker image rm -f $(docker image ls -a | grep -v phpmyadmin | awk '{print $3}' | tail -n +2)\n</code></pre>"},{"location":"docs/","title":"Docs","text":""},{"location":"docs/#convert-epub-to-kindle","title":"convert epub to kindle","text":"<pre><code>sudo apt-get install calibre\nebook-convert file.epub file.mobi\n# connect Kindle wia USB cable\nmv file.mobi /media/$USER/Kindle/documents\n</code></pre>"},{"location":"gnome/","title":"Gnome","text":""},{"location":"gnome/#shortcuts","title":"Shortcuts","text":"<pre><code>gsettings set org.gnome.desktop.wm.keybindings switch-applications \"['&lt;Super&gt;Tab']\" # don't group windows on Alt+Tab\ngsettings set org.gnome.desktop.wm.keybindings switch-windows \"['&lt;Alt&gt;Tab']\"        # don't group windows on Alt+Tab\ngsettings set org.gnome.desktop.wm.keybindings begin-move '[]'                      # release Alt+F7 shortcut for PhpStorm\ngsettings list-recursively org.gnome.desktop.wm.keybindings | grep -F '&lt;Alt&gt;F7'     # find specific shortcut\n\ngsettings set org.gnome.desktop.peripherals.touchpad send-events disabled-on-external-mouse # automatically disable the touchpad when a mouse is plugged in\ngsettings set org.gnome.desktop.peripherals.touchpad send-events enabled                    # undo previous config \n</code></pre>"},{"location":"gnome/#default-gui-text-editor","title":"Default GUI text editor","text":"<p>Find the <code>text/plain=gedit.desktop</code> text in the one of the following files:</p> <p><pre><code>vi ~/.local/share/applications/mimeapps.list   # local user\nsudo vi /usr/share/applications/defaults.list  # all users\nsudo vi /etc/gnome/defaults.list               # defaults\n</code></pre> and replace to</p> <pre><code>text/plain=sublime_text.desktop\n</code></pre>"},{"location":"gnome/#default-console-text-editor","title":"Default Console Text Editor","text":"<pre><code>sudo update-alternatives --config editor\n</code></pre>"},{"location":"gnome/#other","title":"Other","text":"<ol> <li>Make notify-send work from user cron file in ubuntu</li> </ol>"},{"location":"htaccess/","title":"Htaccess","text":""},{"location":"htaccess/#disable-browser-cache-for-specific-folder","title":"Disable Browser Cache for specific folder","text":"<p>Place the following line into .htaccess:</p> <pre><code>Header set Cache-Control \"no-store\" \"expr=%{REQUEST_URI}=~/(VendorName1|VendorName2|requirejs-config\\.js)/i\"\n</code></pre> <p>As result url with \"VendorName\" in path will get <code>Pragma \"no-cache\"</code> http header, so browser won't cache it. This trick is very useful for magento developers who are working with js components or html templates and want to disable cache for a certain folder only.  </p>"},{"location":"htaccess/#basic-auth-with-url-exception","title":"Basic Auth with URL exception","text":"<p>Access /dir/subdir/file.txt file without authorization</p> <pre><code>SetEnvIf Request_URI \"dir\\/subdir\\/file\\.txt$\" no_auth\nAuthType Basic\nAuthUserFile /home/user/public_html/.htpasswd\nAuthName \"Restricted Area\"\nRequire valid-user\nOrder allow,deny\nAllow from env=no_auth\nSatisfy any\n</code></pre>"},{"location":"htaccess/#define-base-path-as-environment-variable-for-further-usage","title":"Define base path as environment variable for further usage","text":"<pre><code>RewriteCond %{REQUEST_URI}::$1 ^(/.+)/(.*)::\\2$\nRewriteRule ^(.*) - [E=BASE:%1]\nRewriteRule ^(.*)$ %{ENV:BASE}/index.php [L]\n</code></pre>"},{"location":"http2/","title":"Http 2","text":""},{"location":"http2/#check-http2-support","title":"Check HTTP2 support","text":"<pre><code>curl --http2 -vI https://http1.golang.org/ 2&gt;&amp;1 | grep ALPN\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* ALPN, server did not agree to a protocol\n\ncurl --http2 -vI https://http2.golang.org/ 2&gt;&amp;1 | grep ALPN\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* ALPN, server accepted to use h2\n</code></pre>"},{"location":"http2/#httpdconf","title":"httpd.conf","text":"<pre><code>Protocols h2 http/1.1\n</code></pre>"},{"location":"images/","title":"Images","text":""},{"location":"images/#remove-exif","title":"Remove EXIF","text":"<pre><code>mogrify -strip *.jpg\n</code></pre>"},{"location":"logs/","title":"Analyze apache/nginx access logs","text":"<p>Show logs for the specific error code <pre><code>cat /var/log/access.log | awk '($9 ~ /400/)'\n</code></pre> Show access logs with non 200 response code <pre><code>cat /var/log/access.log | grep -F 'stripe/webhooks' |  awk '($9 !~ /200/)'\n</code></pre> Show unique user agents <pre><code>cat /var/log/access.log | grep -F '/rest/' | awk -F\\\" '($2 ~ \"^GET /\"){print $6}'\n</code></pre></p>"},{"location":"magento1/","title":"Magento 1","text":""},{"location":"magento1/#setup-dynamic-base-url","title":"Setup Dynamic Base URL","text":"<pre><code>INSERT INTO core_config_data (`path`, `value`) VALUES\n('web/url/use_store',  1), \n('web/unsecure/base_url',  '{{base_url}}'), \n('web/secure/base_url', '{{base_url}}'),\n('web/unsecure/base_link_url', '{{unsecure_base_url}}'),\n('web/unsecure/base_skin_url', '{{unsecure_base_url}}skin/'),\n('web/unsecure/base_media_url', '{{unsecure_base_url}}media/'),\n('web/unsecure/base_js_url', '{{unsecure_base_url}}js/'),\n('web/secure/base_link_url', '{{secure_base_url}}'),\n('web/secure/base_skin_url', '{{secure_base_url}}skin/'),\n('web/secure/base_media_url', '{{secure_base_url}}media/'),\n('web/secure/base_js_url', '{{secure_base_url}}js/')\nON DUPLICATE KEY UPDATE `value` = VALUES(`value`);\n</code></pre>"},{"location":"magento1/#cli-clear-cache","title":"CLI clear cache","text":"<pre><code>php -r 'require \"app/Mage.php\"; Mage::app()-&gt;getCacheInstance()-&gt;flush();'\n</code></pre>"},{"location":"magento1/#unison-profile","title":"Unison profile","text":"<p>~/.unison/magento1.prf</p> <pre><code>include default\nignore = Path var/?*\nignore = Path var/.?*\nignore = Path media\n</code></pre>"},{"location":"magento1/#force-secure-urls","title":"force secure urls","text":"<p>app/etc/local.xml</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;config&gt;\n  &lt;frontend&gt;\n    &lt;secure_url&gt;\n      &lt;all&gt;/&lt;/all&gt;\n    &lt;/secure_url&gt;\n  &lt;/frontend&gt;\n&lt;/config&gt;\n</code></pre>"},{"location":"mysql/","title":"MySQL","text":""},{"location":"mysql/#grant-priviledges","title":"Grant Priviledges","text":"<p><pre><code>GRANT ALL PRIVILEGES ON `db_name`.* TO 'user_name'@'%';\n</code></pre> <pre><code>GRANT ALL PRIVILEGES ON *.* TO 'user_name'@'%';\n</code></pre></p>"},{"location":"mysql/#store-mysql-user-name-and-password","title":"Store mysql user name and password","text":"<p>To use <code>mysql</code> and <code>mysqldump</code> commands without password just store credentials in <code>~/.my.cnf</code> file, e.g.:</p> <pre><code>[client]\nuser=\"devuser\"\npassword=\"devpassword\"\n</code></pre>"},{"location":"mysql/#dump-database-wo-definer","title":"Dump database w/o DEFINER","text":"<ol> <li><pre><code>dbName='dbname' &amp;&amp; mysqldump --no-tablespaces --single-transaction --opt $dbName \\\n  | sed -e 's/DEFINER[ ]*=[ ]*[^*]*\\*/\\*/' \\\n  | gzip &gt; $dbName`date +%Y%m%dT%H%M%S`.sql.gz\n</code></pre></li> <li><pre><code>dbName='dbname' &amp;&amp; mysqldump --no-tablespaces --single-transaction --opt $dbName \\\n  | sed -E 's/DEFINER=[^ *]+//' \\\n  | gzip &gt; $dbName`date +%Y%m%dT%H%M%S`.sql.gz\n</code></pre></li> </ol> <p>Additional useful options:</p> <ul> <li><code>--extended-insert=FALSE</code> - to analyze/edit dump</li> <li><code>--insert-ignore</code> - when db has unique key duplicates (happens some time)</li> <li><code>| sed 's/ AUTO_INCREMENT=[0-9]*//g'</code> - ignore AUTO_INCREMENT  </li> <li><code>--ignore-table=cron_schedule</code> - ignore AUTO_INCREMENT  </li> <li><code>--no-data</code> - dump schema w/o data  </li> <li><code>--no-create-info</code> - dump data w/o schema  </li> <li><code>--no-tablespaces</code> </li> </ul>"},{"location":"mysql/#db-import","title":"DB import","text":"<ol> <li>Regular db import <pre><code>zcat ../db/website-db.sql.gz | sed -E 's/DEFINER=[^ *]+//' | mysql website_db\n</code></pre></li> <li>Workaround in case of importing db from backup with duplicates e.g. \"Duplicate entry 'foo' for key 'bar'\": <pre><code>zcat ../db/website-db.sql.gz | sed 's/INSERT INTO `/INSERT IGNORE INTO `/g' | sed -E 's/DEFINER=[^ *]+//' | mysql website_db\n</code></pre></li> </ol>"},{"location":"mysql/#delete-row-duplicates","title":"Delete row duplicates","text":"<p>check for duplicates <pre><code>SELECT url_rewrite_id, COUNT(*) AS cnt \nFROM catalog_url_rewrite_product_category \nGROUP BY url_rewrite_id \nHAVING cnt &gt; 1; \n</code></pre></p> <p>delete duplicates <pre><code>DELETE FROM catalog_url_rewrite_product_category\nWHERE url_rewrite_id IN (\n    SELECT url_rewrite_id\n    FROM (SELECT\n            url_rewrite_id,\n            ROW_NUMBER() OVER (PARTITION BY url_rewrite_id ORDER BY url_rewrite_id) AS row_num\n         FROM catalog_url_rewrite_product_category\n         ) AS t\n    WHERE row_num &gt; 1\n);\n</code></pre></p>"},{"location":"mysql/#apply-additional-db-patches-from-folder","title":"Apply additional DB patches from folder","text":"<pre><code>cat dev/misc/db/after-import/* | mysql website_db\n</code></pre>"},{"location":"mysql/#find-foreign-key-references","title":"Find foreign key references","text":"All columnsSpecific column <pre><code>SELECT\n    TABLE_NAME,\n    COLUMN_NAME,\n    CONSTRAINT_NAME,\n    REFERENCED_TABLE_NAME,\n    REFERENCED_COLUMN_NAME\nFROM\n    INFORMATION_SCHEMA.KEY_COLUMN_USAGE\nWHERE\n    REFERENCED_TABLE_SCHEMA = 'db_name'\n    AND REFERENCED_TABLE_NAME = 'table_name';\n</code></pre> <pre><code>SELECT\n    TABLE_NAME,\n    COLUMN_NAME,\n    CONSTRAINT_NAME,\n    REFERENCED_TABLE_NAME,\n    REFERENCED_COLUMN_NAME\nFROM\n    INFORMATION_SCHEMA.KEY_COLUMN_USAGE\nWHERE\n    REFERENCED_TABLE_SCHEMA = 'db_name'\n    AND REFERENCED_TABLE_NAME = 'table_name'\n    AND REFERENCED_COLUMN_NAME = 'column_name';\n</code></pre> <p>Source: 1</p>"},{"location":"mysql/#statistics","title":"Statistics","text":"Databases sizeTables size <pre><code>SELECT table_schema AS `database`, \nROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS size_mb \nFROM information_schema.TABLES \nGROUP BY table_schema;\n</code></pre> <pre><code>SELECT table_name AS `table`, \nROUND((data_length + index_length) / 1024 / 1024, 2) AS size_mb \nFROM information_schema.TABLES \nWHERE TABLE_SCHEMA = DATABASE()\nORDER BY size_mb DESC\n</code></pre>"},{"location":"mysql/#locking","title":"Locking","text":"<pre><code>IF GET_LOCK(lock_name, 1) THEN\n-- LOCKING ok, proceed\n    SET @0 = release_lock(lock_name);\nELSE\n-- LOCKING failed, handle this\nEND IF;\n</code></pre>"},{"location":"network/","title":"Network","text":""},{"location":"network/#check-if-port-is-opened","title":"Check if port is opened","text":"<pre><code>$ nc -zvw5 google.com 80\nConnection to google.com 80 port [tcp/http] succeeded!\n</code></pre>"},{"location":"network/#get-nameservers-for-the-domain","title":"Get nameservers for the domain","text":"<pre><code>nslookup -type=soa google.com             # get primary nameserver\nnslookup -type=ns google.com              # get nameservers\ndig +nocmd +noall +answer ns google.com   # get nameservers using dig\n</code></pre>"},{"location":"network/#get-a-record","title":"Get A-record","text":"<pre><code>dig google.com @ns1.google.com\n</code></pre>"},{"location":"network/#get-domain-ttl","title":"Get domain TTL","text":"<pre><code>dig +nocmd +noall +answer +ttlunits google.com @ns1.google.com\n</code></pre>"},{"location":"network/#get-my-ip-address","title":"Get my IP Address","text":"<pre><code>ifconfig eth1 | awk '/inet addr/{print substr($2,6)}'\n</code></pre>"},{"location":"network/#view-ssl-certificate-on-remote-host","title":"View SSL Certificate on remote host","text":"<pre><code>echo | openssl s_client -showcerts -servername gnupg.org -connect gnupg.org:443 2&gt;/dev/null | openssl x509 -inform pem -noout -text\n</code></pre> <pre><code>nmap -p 443 --script ssl-cert gnupg.org\n</code></pre>"},{"location":"network/#set-interface-zone-permanently","title":"Set interface zone permanently","text":"<p>Create a new <code>if-up</code> script <pre><code>touch /etc/network/if-up.d/internal-zone &amp;&amp; chmod +x $_ &amp;&amp; vi $_\n</code></pre></p> <p>Put the following content and save (Shift+ZZ) <pre><code>#!/bin/sh\n\nif [ \"$IFACE\" != \"lxcbr0\" ]; then\n    exit 0\nfi\nfirewall-cmd --zone=internal --change-interface=\"$IFACE\"\n</code></pre> Note: the latest docker has issues if the <code>docker0</code> interface isn't in the <code>docker</code> zone. <pre><code>sudo firewall-cmd --zone=docker --change-interface=docker0\n</code></pre> See stackoverflow</p> <p>Reboot and check <pre><code>$ sudo firewall-cmd --get-active-zones\ndocker\n  interfaces: docker0\ninternal\n  interfaces: lxcbr0\n...\n</code></pre></p>"},{"location":"network/#file-transfer-via-network","title":"File Transfer via network","text":"<p>Sender: <pre><code>nc -v -l 80 &lt; file.gz\n</code></pre> Receiver: <pre><code>nc -w 3 remote-ip 80 &gt; file.gz\n</code></pre></p>"},{"location":"network/#openwrt","title":"OpenWRT","text":""},{"location":"network/#speed-test-with-iperf3","title":"Speed test with iperf3","text":"<p><pre><code># iperf3 -c ping.online.net -u -b 1G \nConnecting to host ping.online.net, port 5201\n[  5] local xxx.xxx.xxx.xxx port 46361 connected to 62.210.18.40 port 5201\n[ ID] Interval           Transfer     Bitrate         Total Datagrams\n[  5]   0.00-1.00   sec   114 MBytes   956 Mbits/sec  82519  \n[  5]   1.00-2.00   sec   111 MBytes   931 Mbits/sec  80335  \n[  5]   2.00-3.00   sec   108 MBytes   909 Mbits/sec  78439  \n[  5]   3.00-4.00   sec   109 MBytes   918 Mbits/sec  79250  \n[  5]   4.00-5.00   sec   109 MBytes   914 Mbits/sec  78939  \n[  5]   5.00-6.00   sec   109 MBytes   917 Mbits/sec  79203  \n[  5]   6.00-7.00   sec   111 MBytes   930 Mbits/sec  80253  \n[  5]   7.00-8.00   sec   110 MBytes   924 Mbits/sec  79802  \n[  5]   8.00-9.00   sec   110 MBytes   923 Mbits/sec  79676  \n[  5]   9.00-10.00  sec   111 MBytes   931 Mbits/sec  80381  \n- - - - - - - - - - - - - - - - - - - - - - - - -\n[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams\n[  5]   0.00-10.00  sec  1.08 GBytes   925 Mbits/sec  0.000 ms  0/798797 (0%)  sender\n[  5]   0.00-10.00  sec   114 MBytes  95.7 Mbits/sec  0.009 ms  716162/798783 (90%)  receiver\n\niperf Done.\n</code></pre> - Results interpretation - iperf3 servers</p>"},{"location":"network/#set-up-dropbear-public-key-authentication","title":"Set up Dropbear public key authentication","text":"<pre><code>ssh-copy-id  root@192.168.1.1\nssh root@192.168.1.1\ncp /root/.ssh/authorized_keys /etc/dropbear/\nchmod 700 /etc/dropbear\nchmod 600 /etc/dropbear/authorized_keys\n</code></pre>"},{"location":"network/#ip-addresses-daily-log-cron-job","title":"IP Addresses daily log (cron job)","text":"<pre><code>0 4 * * * echo \"`date +%Y-%m-%d` $(ifconfig eth1 | awk '/inet addr/{print substr($2,6)}')\" &gt;&gt; /root/ip.log\n</code></pre>"},{"location":"network/#port-mapping","title":"Port Mapping","text":"<p>ssh -L [LOCAL_IP:]LOCAL_PORT:DESTINATION:DESTINATION_PORT [USER@]SSH_SERVER <pre><code>ssh -L 103306:db-server:3306 user@web.server.com\n</code></pre></p>"},{"location":"patch/","title":"Patch","text":""},{"location":"patch/#create-directory-patch","title":"Create Directory Patch","text":"<p><pre><code>diff --exclude=\".git\" -ruN orig/ new/ | sed \"s#new/#b/#\" | sed 's#orig/#a/#' &gt; patch.sql\n</code></pre> where:</p> <pre><code>-r - recursive, so do subdirectories\n-u - unified style, if your system lacks it or if recipient may not have it, use \"-c\"\n-N - treat absent files as empty\n</code></pre> <p>References: 1, 2.</p>"},{"location":"patch/#apply-patch","title":"Apply Patch","text":"<pre><code>patch '-p1' --no-backup-if-mismatch -d 'vendor/vendor-name/module-name' &lt; '_extra/patches/vendor-name/module-name/patch-name.patch'\n</code></pre>"},{"location":"pdf/","title":"PDF","text":""},{"location":"pdf/#create-pdf-from-images","title":"Create pdf from images","text":"<pre><code>montage 01.jpg 02.jpg 03.jpg -tile 1x1 -geometry 1000 -page A4 -compress jpeg -quality 75 -background white my-document.pdf\n</code></pre>"},{"location":"pdf/#create-booklet","title":"Create Booklet","text":"<pre><code>pdfbook --short-edge --frame true --scale 0.95 file.pdf\n</code></pre>"},{"location":"pdf/#split-pdf","title":"Split pdf","text":"<pre><code>pdftk input.pdf cat 1 output output_p1.pdf\n</code></pre>"},{"location":"pdf/#convert-pdf-to-jpg","title":"Convert PDF to JPG","text":"<pre><code>vips copy sample.pdf[dpi=300,page=0] sample-page-1.jpg\n</code></pre>"},{"location":"pdf/#optimize-pdf","title":"Optimize PDF","text":"<p><pre><code>gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/printer -dNOPAUSE -dQUIET -dBATCH -sOutputFile=output.pdf input.pdf\n</code></pre> <pre><code>-dPDFSETTINGS=/screen   Has a lower quality and smaller size. (72 dpi)\n-dPDFSETTINGS=/ebook    Has a better quality, but has a slightly larger size (150 dpi)\n-dPDFSETTINGS=/prepress Output is of a higher size and quality (300 dpi)\n-dPDFSETTINGS=/printer  Output is of a printer type quality (300 dpi)\n-dPDFSETTINGS=/default  Selects the output which is useful for multiple purposes. Can cause large PDFS.\n</code></pre></p>"},{"location":"pdf/#extract-images-from-pdf","title":"Extract images from PDF","text":"<p><pre><code>pdfimages -all file.pdf .\n</code></pre> Source</p>"},{"location":"performance/","title":"Performance","text":""},{"location":"performance/#strace","title":"Strace","text":"<p>Slow SQL Queries <pre><code>strace -p&lt;FPM_PID&gt; -T -r --trace=sendto,recvfrom \n</code></pre></p> <p>Slow Filesystem <pre><code>strace -p&lt;FPM_PID&gt; -T --trace=access,open \n</code></pre></p>"},{"location":"php/","title":"PHP","text":""},{"location":"php/#date-diff","title":"Date Diff","text":"<pre><code>php -r \"echo (new DateTime('2019-10-31 14:37:17'))-&gt;diff(new DateTime('2019-10-29 10:03:05'))-&gt;format('%R%ad%Hh');\"\n</code></pre>"},{"location":"php/#useful-links","title":"Useful links","text":"<ul> <li>Accessing private properties in PHP</li> </ul>"},{"location":"php/#phpcs-phpcbf","title":"phpcs &amp; phpcbf","text":"<pre><code>cd ~/bin\nwget https://squizlabs.github.io/PHP_CodeSniffer/phpcs.phar -O phpcs &amp;&amp; chmod +x phpcs\nwget https://squizlabs.github.io/PHP_CodeSniffer/phpcbf.phar -O phpcbf &amp;&amp; chmod +x phpcbf\n\n# check supported standards\n$ phpcs -i\nThe installed coding standards are MySource, PEAR, PSR1, PSR12, PSR2, Squiz and Zend\n\n# add custom standard, e.g\ncd ~/opt\ngit clone https://github.com/magento/magento-coding-standard\ncd magento-coding-standard\ncomposer install\n\n# add custom standsrd to phpcs\nphpcs --config-set installed_paths /opt/magento-coding-standard\n# check supported standards (see that Magento2 standsrd is added)\n$ phpcs -i\nThe installed coding standards are MySource, PEAR, PSR1, PSR12, PSR2, Squiz, Zend and Magento2\n</code></pre> <p>Other commands may be useful:</p> <pre><code>phpcs --config-show installed_paths\n\n# remove installed_paths if they are wrong\nphpcs --config-delete installed_paths\n</code></pre>"},{"location":"phpstorm/","title":"prevent marking vendor/company/module-name directories as excluded","text":"<pre><code>Settings &gt; PHP &gt; Composer &gt; [ ] Add packages as libraries (should be disabled) \n</code></pre>"},{"location":"raspberry-pi/","title":"GPU Memory","text":"<p>show current gpu memory config <pre><code>vcgencmd get_mem gpu\n</code></pre></p> <p>change gpu memory <pre><code>vi /boot/config.txt\n# add/change the following line\n[all]\ngpu_mem=256\n</code></pre></p>"},{"location":"redis/","title":"Redis","text":""},{"location":"redis/#useful-commands","title":"Useful commands","text":"<pre><code>redis-cli FLUSHDB  # delete all the keys of the currently selected DB.\nredis-cli FLUSHALL # delete all the keys of all the existing databases, not just the currently selected one.\n</code></pre>"},{"location":"ssh/","title":"SSH","text":""},{"location":"ssh/#separate-ssh-key-for-a-specific-host","title":"Separate ssh key for a specific host","text":"<p>vi ~/.ssh/config</p> <pre><code>Host github.com\n    IdentityFile ~/.ssh/github_id_rsa.pub\n</code></pre>"},{"location":"system/","title":"System","text":""},{"location":"system/#info","title":"Info","text":"<pre><code>#system info in short format\ninxi -F\n</code></pre>"},{"location":"system/#disable-selinux","title":"Disable Selinux","text":"<pre><code>#runtime\nsudo setenforce 0\n\n#permanently\n/etc/selinux/config\nSELINUX=disabled\n</code></pre>"},{"location":"system/#kernel-parameters","title":"Kernel parameters","text":"<p>vi /etc/sysctl.conf</p> <pre><code># custom settings\n\n$ disable IPv6\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\nnet.ipv6.conf.lo.disable_ipv6 = 1\n\n# Increase inotify.max_user_watches (https://github.com/guard/listen/wiki/Increasing-the-amount-of-inotify-watchers)   \nfs.inotify.max_user_watches = 524288\n</code></pre> <p>Reload kernel parameters</p> <pre><code>sysctl -p\n</code></pre>"},{"location":"system/#battery-info","title":"Battery Info","text":"<p><pre><code>upower -i /org/freedesktop/UPower/devices/battery_BAT0\n</code></pre> output: <pre><code>native-path:          BAT0\nvendor:               Hewlett-Packard\nmodel:                Primary\npower supply:         yes\nupdated:              Fri 12 Mar 2021 11:39:46 EET (58 seconds ago)\nhas history:          yes\nhas statistics:       yes\nbattery\npresent:             yes\nrechargeable:        yes\nstate:               discharging\nwarning-level:       none\nenergy:              58.7664 Wh\nenergy-empty:        0 Wh\nenergy-full:         58.7664 Wh\nenergy-full-design:  57.288 Wh\nenergy-rate:         6.8376 W\nvoltage:             12.783 V\ntime to empty:       8.6 hours\npercentage:          100%\ncapacity:            100%\ntechnology:          lithium-ion\nicon-name:          'battery-full-symbolic'\nHistory (rate):\n1615541986  6.838   discharging\n</code></pre></p>"},{"location":"system/#show-list-of-files-accessed-by-the-process","title":"Show list of files accessed by the process","text":"<pre><code>strace -f -t -e trace=file mgc project:info 2&gt;&amp;1 | grep access | sort | uniq\n</code></pre>"},{"location":"system/#manage-monitors-brightness","title":"Manage monitors brightness","text":"<pre><code>#!/bin/bash\n\nif [ $# -ne 1 ] ; then\n    echo \"Usage: \"\n    echo \"$0 &lt;brightness-level&gt;\"\n    echo \"e.g.: $0 0.8\"\n    exit 0\nfi\n\nfor output in $(xrandr | grep ' connected' | awk '{print $1}'); do\n    xrandr --output \"$output\" --brightness $1\ndone\n</code></pre>"},{"location":"xdebug/","title":"Xdebug","text":""},{"location":"xdebug/#php-cli","title":"PHP-CLI","text":"<pre><code>XDEBUG_SESSION=XDEBUG_ECLIPSE php -dxdebug.remote_autostart=1 script.php\n</code></pre>"},{"location":"bash/fu/","title":"FU","text":""},{"location":"bash/fu/#generate-a-random-password-30-characters-long","title":"Generate a random password 30 characters long","text":"<pre><code>strings /dev/urandom | grep -o '[[:alnum:]]' | head -n 30 | tr -d '\\n'; echo\n</code></pre>"},{"location":"bash/general/","title":"General","text":""},{"location":"bash/general/#filter-output-keeping-the-first-line","title":"filter output keeping the first line","text":"<pre><code>df -h | awk 'NR==1||/var$/' \nFilesystem                                     Size  Used Avail Use% Mounted on\n/dev/mapper/system-var                         9.8G  6.2G  3.2G  67% /var\n</code></pre>"},{"location":"bash/general/#path-info","title":"path info","text":"<pre><code>file=\"/home/user/file.inc.php\"\nbasename=${file##*/}       # file.inc.php\nfilename=${basename%.*}    # file.inc\nextension=${file##*.}      # php\ndirname=${file%/*}         # /home/user\n</code></pre>"},{"location":"bash/general/#ssh-authentication-by-key","title":"SSH authentication by key","text":"<p><pre><code>cd ~/.ssh\nssh-keygen\nssh-copy-id -i ~/.ssh/id_rsa.pub remote.host.com\nssh-add\nssh remote.host.com\n</code></pre> If username has a \u201c@\u201d symbol then use the following: <pre><code>ssh -l user@example.com example.com\nmkdir .ssh\ntouch .ssh/authorized_keys\nexit\ncat ~/.ssh/id_rsa.pub | ssh -l user@example.com example.com 'cat &gt;&gt; .ssh/authorized_keys'\nchmod 700 .ssh\nchmod 400 .ssh/authorized_keys\nssh -l user@example.com example.com\n</code></pre></p>"},{"location":"bash/general/#bash-prompt-w-path-and-colors","title":"Bash prompt w/ path and colors","text":"<p><code>~/.bash_profile</code>:</p> <p>Local (green) <pre><code>export PS1=\"\\[\\e[0;38;05;15m\\][\\[\\e[0;38;05;47m\\]\\u\\[\\e[0;38;05;15m\\]@\\[\\e[0;38;05;208m\\]\\h:\\[\\e[0;38;05;111m\\]\\w\\[\\e[0;38;05;15m\\]]\\\\$ \\[\\e[0m\\]\"\n</code></pre> Remote (yellow): <pre><code>export PS1=\"\\[\\e[0;38;05;15m\\][\\[\\e[0;38;05;226m\\]\\u\\[\\e[0;38;05;15m\\]@\\[\\e[0;38;05;226m\\]\\h:\\[\\e[0;38;05;180m\\]\\w\\[\\e[0;38;05;15m\\]]\\\\$ \\[\\e[0m\\]\"\n</code></pre> Root (red and yellow) <pre><code>export PS1=\"\\[\\e[0;38;05;15m\\][\\[\\e[0;38;05;196m\\]\\u\\[\\e[0;38;05;15m\\]@\\[\\e[0;38;05;226m\\]\\h:\\[\\e[0;38;05;180m\\]\\w\\[\\e[0;38;05;15m\\]]\\\\$ \\[\\e[0m\\]\"\n</code></pre></p>"},{"location":"bash/general/#colors","title":"Colors","text":"<p><pre><code>for i in {0..255}; do echo -e \"\\e[38;05;${i}m${i}\"; done | column -c 80 -s '  '; echo -e \"\\e[m\"\n</code></pre> <pre><code>for code in $(seq -w 0 255); do for attr in 0 1; do printf \"%s-%03s %bTest%b\\n\" \"${attr}\" \"${code}\" \"\\e[${attr};38;05;${code}m\" \"\\e[m\"; done; done | column -c $((COLUMNS*2))\n</code></pre></p>"},{"location":"bash/general/#vim","title":"Vim","text":"<p>~/.vimrc <pre><code>set nocompatible\nset backspace=2\nset tabstop=4\nset expandtab\nset number\n</code></pre></p>"},{"location":"bash/general/#load-additional-phpini-when-run-php-from-terminal","title":"Load additional php.ini when run php from terminal","text":"<ol> <li> <p>Add the following line into ~/.bashrc file:</p> <p><code>export PHP_INI_SCAN_DIR=\":$HOME/etc/php70\"</code></p> </li> <li> <p>Put additional config into ~/etc/php70/php.ini, e.g:</p> <p><code>memory_limit = -1</code></p> </li> <li> <p>Run the command #1 or re-login terminal </p> </li> <li> <p>Check ini paths:</p> <p><code>php --ini</code></p> </li> <li> <p>Check memory limit:</p> <pre><code>$ php -i | grep memory_limit\nmemory_limit =&gt; -1 =&gt; -1\n</code></pre> </li> </ol> <p>More info on php.net</p>"},{"location":"bash/general/#convert-dos-to-unix-newlines-in-current-directory-excluding-git-directory","title":"Convert DOS to Unix newlines in current directory excluding .git directory","text":"<pre><code>find . -type f -not -path './.git/*' -print0 | xargs -0 dos2unix\n</code></pre>"},{"location":"bash/general/#use-custom-ssh-port-with-rsyncsshscpsshfs","title":"Use custom SSH port with rsync/ssh/scp/sshfs","text":"<pre><code>rsync -avz -e \"ssh -p 2244\" --exclude=var user@server.com:/html/ .\nssh user@server.com -p 2244\nscp -P 2244 user@server.com:/html/website_db.sql .\nsshfs user@server.com:/html -p 2244 server.com\n</code></pre>"},{"location":"bash/general/#upload-multiple-files-wo-file-name-duplication","title":"Upload multiple files w/o file name duplication","text":"<pre><code>scp {,user@example.com:~/}public_html/index.php\nscp {,user@example.com:~/}public_html/.htaccess\nscp {,user@example.com:~/}public_html/images/logo.png\nscp {,user@example.com:~/}public_html/js/jquery.js \n</code></pre>"},{"location":"bash/general/#fix-permissions","title":"FIX permissions","text":"<pre><code>find . -type f -exec chmod 640 {} \\;\nfind . -type d -exec chmod 750 {} \\;\n</code></pre>"},{"location":"bash/general/#statistics","title":"Statistics","text":""},{"location":"bash/general/#find-of-code-lines-in-directory","title":"Find # of code lines in directory","text":"<pre><code>(find . -type f -name '*.php' -print0 | xargs -0 cat) | wc -l\n</code></pre>"},{"location":"bash/general/#datetime-format","title":"Date/Time format","text":"<pre><code>date +%Y-%m-%d\\ %H:%M:%S\\ %:z     # 2020-04-02 21:53:08 +03:00\ndate -Iseconds                    # 2020-04-02T23:02:42+03:00\n</code></pre>"},{"location":"bash/general/#ctrlc-hook","title":"Ctrl+C Hook","text":"<pre><code>trap ctrl_c INT\n\nfunction ctrl_c() {\n    echo \"Triggered CTRL+C event\"\n}\n</code></pre>"},{"location":"bash/general/#process-start-end-time","title":"Process start end time","text":"<pre><code>ps -eo pid,lstart,etime,args | sed '1p;/php/!d'\n</code></pre>"},{"location":"bash/general/#diff-large-files","title":"Diff large files","text":"<p><pre><code>diff -y --suppress-common-lines --speed-large-files file1 file2\n</code></pre> Source: unix.stackexchange.com</p>"},{"location":"bash/general/#useful-links","title":"Useful links","text":"<ol> <li>How to parse command line arguments</li> </ol>"},{"location":"git/branch/","title":"Branch","text":""},{"location":"git/branch/#misc","title":"Misc","text":""},{"location":"git/branch/#remove-gone-branches","title":"Remove gone branches","text":"<p><pre><code>git fetch -p &amp;&amp; git branch -vv | awk '/: gone]/{print $1}' | xargs git branch -D\n</code></pre> Sources: 1, 2.</p>"},{"location":"git/branch/#replace-local-branch-with-origin","title":"Replace local branch with origin","text":"<p><pre><code>git reset --hard origin/featureXXX\n</code></pre> Source: 1</p>"},{"location":"git/branch/#merge","title":"Merge","text":""},{"location":"git/branch/#check-if-commit-merged","title":"Check if commit merged:","text":"<pre><code>git fetch origin # ??\ngit branch -r --contains &lt;commit&gt;\n</code></pre>"},{"location":"git/branch/#merged-branches","title":"Merged branches","text":"<pre><code>git branch --merged master      # local branches\ngit branch -r --merged master   # remote branches\ngit branch -a --merged master   # all branches\n</code></pre>"},{"location":"git/branch/#not-merged-branches","title":"Not merged branches","text":"<pre><code>git branch --no-merged master      # local branches\ngit branch -r --no-merged master   # remote branches\ngit branch -a --no-merged master   # all branches\n</code></pre>"},{"location":"git/branch/#-dry-run","title":"--dry-run","text":"<p><pre><code>git merge --no-commit --no-ff my_branch\ngit diff --cached\ngit merge --abort\n</code></pre> see stackoverflow</p>"},{"location":"git/branch/#squash","title":"Squash","text":"<p>Merge branch as a new single commit: <pre><code>git checkout master\ngit merge --squash bugfix\ngit commit\n</code></pre></p>"},{"location":"git/branch/#remove","title":"Remove","text":"<pre><code>git branch -a                             # show list of branches\ngit branch -d &lt;branch_name&gt;               # remove \u201c&lt;branch_name&gt;\u201d branch locally\ngit push origin --delete &lt;branch_name&gt;    # remove remote \u201c&lt;branch_name&gt;\u201d branch\ngit branch -a                             # show list of branches to ensure \u201c&lt;branch_name&gt;\u201d is removed\n</code></pre>"},{"location":"git/branch/#rename","title":"Rename","text":"<p><pre><code>git branch -m old-name new-name           # rename\ngit push origin :old-name new-name        # push to origin\ngit push origin -u new-name               # add upstream (tracking) reference\n</code></pre> Source: 1</p>"},{"location":"git/branch/#rebase","title":"Rebase","text":"<pre><code>git checkout master\ngit pull\ngit checkout my_brarch\ngit rebase -i master        # pick first comment and fixup the rest ones\ngit push\n#git push -f                # if changed were already pushed to remote\n</code></pre>"},{"location":"git/branch/#rebase-onto-another-branch","title":"Rebase onto another branch","text":"<p>Precondition: <pre><code>git checkout master\ngit checkout -b feature_1 # create a branch from master\n# add &amp; commit changes\ngit checkout -b feature_2 # create a branch from feature_1\n# add &amp; commit changes\n</code></pre> Rebase <code>feature_2</code> onto <code>master</code> branch:  <pre><code>git checkout feature_2\ngit rebase --onto master feature_1\n</code></pre> More info</p>"},{"location":"git/branch/#rebase-onto-a-rebased-branch","title":"Rebase onto a rebased branch","text":"<p><pre><code> git rebase --onto feature1 feature1@{1} feature2\n</code></pre> More info</p>"},{"location":"git/branch/#reverting-git-rebase","title":"Reverting git rebase","text":"<p><pre><code>git reflog\ngit reset --hard HEAD@{2} # be absolutely sure before resetting with the --hard option\n</code></pre> Source: 1</p>"},{"location":"git/branch/#undoing-a-git-push","title":"Undoing a 'git push'","text":"<p><pre><code>git push -f origin last_known_good_commit:branch_name\n</code></pre> Source: 1</p>"},{"location":"git/branch/#copy-commit-to-a-new-branch","title":"Copy commit to a new branch:","text":"<pre><code>git checkout -b new_branch_name\ngit cherry-pick &lt;commit&gt;\n</code></pre>"},{"location":"git/branch/#back-branch-to-the-last-good-commit","title":"Back branch to the last good commit:","text":"<pre><code>git checkout branch_name\ngit reset --hard &lt;last_good_commit&gt;\ngit push -f\n</code></pre>"},{"location":"git/config/","title":"Config","text":""},{"location":"git/config/#list-of-global-configs","title":"List of global configs","text":"<pre><code>git config --global -l\n</code></pre>"},{"location":"git/config/#global-gitignore","title":"Global .gitignore","text":"<p><pre><code>git config --global core.excludesfile ~/.gitignore\n</code></pre> <pre><code>vi ~/.gitignore\n</code></pre> <pre><code>.idea\nvendor\nstudio\n.phpv\n.sass-cache\n</code></pre></p>"},{"location":"git/config/#log-alias","title":"Log alias","text":"<p><pre><code>git config --global alias.lg \"log --color --pretty=format:'%Cred%h%Creset - %s %Cgreen(%cr %ci) %C(bold blue)&lt;%an&gt;%Creset %C(yellow)%d%Creset' --abbrev-commit\"\n</code></pre> <pre><code>git config --global alias.lgm \"log --pretty=oneline --abbrev-commit\"\n</code></pre></p>"},{"location":"git/config/#automatically-prune","title":"Automatically prune","text":"<p>Before fetching, automatically remove any remote-tracking references that no longer exist on the remote. <pre><code>git config --global fetch.prune true\n</code></pre></p>"},{"location":"git/config/#remote","title":"Remote","text":"<pre><code>git remote -v                                          # show\ngit remote add origin git@github.com:user/repo.git     # add\ngit remote set-url origin git@github.com:user/repo.git # change\n</code></pre>"},{"location":"git/config/#misc","title":"MISC","text":"<pre><code>git config --global core.commentChar ';' # change comment character\n</code></pre>"},{"location":"git/diff/","title":"Diff","text":""},{"location":"git/diff/#list-of-changed-files","title":"List of changed files","text":"<pre><code>git diff --name-only SHA1 SHA2        # between two comments\ngit diff --name-only HEAD~2 HEAD      # between last two comments\n</code></pre>"},{"location":"git/log/","title":"Log","text":""},{"location":"git/log/#find-a-deleted-file-in-the-commit-history","title":"Find a deleted file in the commit history","text":"<p><pre><code>git log --all --full-history -- \"**/thefile.*\"\n</code></pre> <pre><code>git log --all --full-history -- &lt;path-to-file&gt;\n</code></pre> source</p>"},{"location":"git/log/#list-of-commits-between-branches","title":"List of commits between branches","text":"<pre><code>git log --oneline release-1..develop\n</code></pre>"},{"location":"git/log/#log-with-file-list","title":"Log with file list","text":"<pre><code>git log --name-status\n</code></pre>"},{"location":"git/log/#define-parent-branch","title":"define parent branch","text":"<pre><code>git log --pretty=format:'%D' HEAD^ | grep 'origin/' | head -n1 | sed 's@origin/@@' | sed 's@,.*@@'\n</code></pre>"},{"location":"git/log/#find-deleted-file","title":"find deleted file","text":"<pre><code>git log --all --full-history -- '**/file.*'\n</code></pre>"},{"location":"git/misc/","title":"Misc","text":"<ol> <li>list of unmerged files and locally changed files:     <pre><code>(git diff --no-commit-id --name-only origin/$parent..HEAD; git status --porcelain | sed s/^...//) | sort | uniq\n</code></pre></li> <li>Skip gitlab CI <pre><code>git push -o ci.skip\n</code></pre> Source: 1</li> <li>Restore staged file <pre><code>git restore --staged &lt;file&gt;\n</code></pre></li> <li>Remove a git commit which has not been pushed <pre><code>git reset --hard HEAD^\n</code></pre> Source: 1</li> </ol>"},{"location":"git/oh-my-git/","title":"Oh My Git","text":""},{"location":"git/oh-my-git/#installation","title":"Installation","text":"<ol> <li> <p>Checkout oh-my-git and switch to the \"theme\" branch <pre><code>sudo su -\ncd /opt\ngit clone https://github.com/yutv/oh-my-git\ncd oh-my-git\ngit checkout theme\nexit\n</code></pre></p> </li> <li> <p>Add the following lines into your ~/.bashrc <pre><code>declare -A OMG_THEME=([\"right_side_bg\"]='green')\nsource /opt/oh-my-git/prompt.sh    \n</code></pre></p> </li> <li> <p>Install FontAwesome</p> UbuntuFedora <ol> <li><pre><code>apt install fonts-font-awesome\n</code></pre></li> <li>Gnome Tweaks &gt; Fonts &gt; Monospace Text = SourceCodePro+PowerLine+Awesome Regular Regular    11 </li> </ol> <pre><code>cd /tmp\ngit clone http://github.com/gabrielelana/awesome-terminal-fonts\ncd awesome-terminal-fonts\ngit checkout patching-strategy\nmkdir -p ~/.fonts\ncp patched/*.ttf ~/.fonts\n\n# update the font-info cache\nsudo fc-cache -fv ~/.fonts\n\nrm -Rf /tmp/awesome-terminal-fonts\n</code></pre> </li> <li> <p>Now try to change directory to a git repo and you will see a git info bar, e.g.:  </p> </li> </ol>"},{"location":"git/patch/","title":"Patch","text":""},{"location":"git/patch/#create-a-git-patch","title":"Create a Git Patch","text":"<p><pre><code>git format-patch -1 HEAD\n</code></pre> where  - <code>-n</code> number of commits from the topmost one  </p> <p>Source: stackoweflow </p>"},{"location":"git/patch/#apply-git-patch","title":"Apply Git Patch","text":"<pre><code>git am &lt; file.patch\n</code></pre>"},{"location":"git/stash/","title":"Stash","text":"<pre><code>git stash                     # create a stash\ngit stash pop                 # apply &amp; remove the recent stash\ngit stash show                # recent stash files\ngit stash show -p             # recent stash diff\ngit stash list                # stashes list\ngit stash show -p stash@{1}   # specific stash diff\n</code></pre>"},{"location":"git/tag/","title":"Tag","text":""},{"location":"git/tag/#set-tag","title":"Set tag","text":"<pre><code>git tag v1.1.2              # set tag in the local repository\ngit push origin v1.1.2      # push tag to the remote repository\n</code></pre>"},{"location":"magento-2/bulk-actions/","title":"Bulk Actions","text":"Bash Environment Configuration <p>~/.bashrc.d/env <pre><code>export PS1=\"\\[\\e[0;38;05;15m\\][\\[\\e[0;38;05;47m\\]\\u\\[\\e[0;38;05;15m\\]@\\[\\e[0;38;05;153m\\]\\h:\\[\\e[0;38;05;111m\\]\\w\\[\\e[0;38;05;15m\\]]\\\\$ \\[\\e[0m\\]\"\nalias m2-clean='rm -Rf generated/* var/cache/* var/page_cache/* var/di/* var/view_preprocessed/* pub/static/* &amp;&amp; redis-cli FLUSHALL'\nalias m2-cssclean=\"rm -Rf var/view_preprocessed/* &amp;&amp; find pub/static/ -name 'styles-*.css' -exec rm -f {} \\;\"\nalias m2-translation-clean=\"find pub/static/ -name 'js-transl*.*' -exec rm -f {} \\; &amp;&amp; php bin/magento cache:clean translate\"\n</code></pre> ~/.profile <pre><code>export PATH=\"$HOME/bin:$PATH\"\n</code></pre></p>"},{"location":"magento-2/bulk-actions/#trigger-processing-bulk-actions","title":"Trigger processing bulk actions","text":"<pre><code>php bin/magento queue:consumers:start product_action_attribute.update --single-thread --max-messages=10000\n</code></pre>"},{"location":"magento-2/bulk-actions/#misc","title":"Misc","text":"<p>Tables: - magento_bulk</p> <p>BO Save product attributes: https://dev.local/admin/catalog/product_action_attribute/save/store/0/active_tab/inventory/</p>"},{"location":"magento-2/configuration/","title":"Configuration","text":"Bash Environment Configuration <p>~/.bashrc.d/env <pre><code>export PS1=\"\\[\\e[0;38;05;15m\\][\\[\\e[0;38;05;47m\\]\\u\\[\\e[0;38;05;15m\\]@\\[\\e[0;38;05;153m\\]\\h:\\[\\e[0;38;05;111m\\]\\w\\[\\e[0;38;05;15m\\]]\\\\$ \\[\\e[0m\\]\"\nalias m2-clean='rm -Rf generated/* var/cache/* var/page_cache/* var/di/* var/view_preprocessed/* pub/static/* &amp;&amp; redis-cli FLUSHALL'\nalias m2-cssclean=\"rm -Rf var/view_preprocessed/* &amp;&amp; find pub/static/ -name 'styles-*.css' -exec rm -f {} \\;\"\nalias m2-translation-clean=\"find pub/static/ -name 'js-transl*.*' -exec rm -f {} \\; &amp;&amp; php bin/magento cache:clean translate\"\n</code></pre> ~/.profile <pre><code>export PATH=\"$HOME/bin:$PATH\"\n</code></pre></p>"},{"location":"magento-2/configuration/#sign-static-files","title":"Sign Static Files","text":"<p>Disable timestamp in static files like <code>pub/static/version12345993943/file.js</code></p> bashMagento Adminsql <pre><code>php bin/magento config:set dev/static/sign 0\n</code></pre> <pre><code>Stores &gt; Configuration &gt; Advanced &gt; Developer &gt; Static Files Settings &gt; Sign Static Files &gt; No\n</code></pre> <pre><code>INSERT INTO core_config_data (`path`, `value`) VALUES ('dev/static/sign', 0) \nON DUPLICATE KEY UPDATE `value` = VALUES(value);\n</code></pre>"},{"location":"magento-2/configuration/#general","title":"General","text":"<p>Stores &gt; Configuration &gt; General &gt; Web <pre><code>php bin/magento config:set \"web/cookie/cookie_lifetime\" 256000        # Default Cookie Settings &gt; Cookie Lifetime\nphp bin/magento config:set \"web/seo/use_rewrites\" 1                   # Search Engine Optimization &gt; Use Web Server Rewrites = Yes\n</code></pre> Stores &gt; Configuration &gt; Mageplaza Extensions &gt; General Configuration <pre><code>php bin/magento config:set \"smtp/general/enabled\" 0                   # Enable Mageplaza SMTP = No\n</code></pre></p> <p>Set Base URL <pre><code>php bin/magento setup:store-config:set --base-url='http://example.com/' \\\n  --base-url-secure='https://example.com/' \\\n  --use-secure=1 \\\n  --use-secure-admin=1\n</code></pre> <pre><code>php bin/magento cache:clean\nphp bin/magento cache:flush\n</code></pre></p>"},{"location":"magento-2/configuration/#admin","title":"Admin","text":"<p>Stores &gt; Configuration &gt; Advanced &gt; Admin <pre><code>php bin/magento config:set \"admin/captcha/enable\" 0                   # CAPTCHA &gt; Enable CAPTCHA in Admin = No\n</code></pre> Stores &gt; Configuration &gt; Advanced &gt; Admin &gt; Security <pre><code>php bin/magento config:set \"admin/security/session_lifetime\" 31536000 # Admin Session Lifetime (seconds)\nphp bin/magento config:set \"admin/security/password_lifetime\" \"\"      # Password Lifetime (days)\nphp bin/magento config:set \"admin/security/admin_account_sharing\" 1   # Admin Account Sharing = Yes\nphp bin/magento config:set \"admin/security/lockout_failures\" \"\"       # Maximum Login Failures to Lockout Account = \"\"\nphp bin/magento config:set \"admin/security/password_is_forced\" 0      # Password Change = \"Recommended\"\nphp bin/magento config:set \"admin/security/use_form_key\" 0            # Add Secret Key to URLs = No\n</code></pre></p>"},{"location":"magento-2/configuration/#cssjs","title":"CSS/JS","text":"<p>Stores &gt; Configuration &gt; Advanced &gt; CSS Settings <pre><code>php bin/magento config:set \"dev/css/merge_css_files\" 0                # Merge CSS Files = No\nphp bin/magento config:set \"dev/css/minify_files\" 0                   # Minify CSS Files = No\n</code></pre></p> <p>Stores &gt; Configuration &gt; Advanced &gt; JavaScript Settings <pre><code>php bin/magento config:set \"dev/js/merge_files\" 0                     # Merge JavaScript Files = No\nphp bin/magento config:set \"dev/js/enable_js_bundling\" 0              # Enable JavaScript Bundling = No\nphp bin/magento config:set \"dev/js/minify_files\" 0                    # Minify JavaScript Files = No\n</code></pre></p>"},{"location":"magento-2/configuration/#debug","title":"Debug","text":"<p>Template Hints</p> <p><pre><code>php bin/magento config:set \"dev/debug/template_hints_storefront\" 1 &amp;&amp; php bin/magento config:set \"dev/debug/template_hints_blocks\" 1 # enable\n</code></pre> <pre><code>php bin/magento config:set \"dev/debug/template_hints_storefront\" 0 &amp;&amp; php bin/magento config:set \"dev/debug/template_hints_blocks\" 0 # disable\n</code></pre></p> <p>Magento Admin</p> <p>Stores &gt; Configuration &gt; Advanced &gt; Developer &gt; Debug &gt; Enabled Template Path Hints for Storefront     Stores &gt; Configuration &gt; Advanced &gt; Developer &gt; Debug &gt; Add Block Class Type to Hints</p> <p>Debug Logging <pre><code>php bin/magento setup:config:set --enable-debug-logging=true &amp;&amp; php bin/magento cache:flush   # enable\n</code></pre> <pre><code>php bin/magento setup:config:set --enable-debug-logging=false &amp;&amp; php bin/magento cache:flush  # disable\n</code></pre></p> <p>Syslog Logging <pre><code>php bin/magento setup:config:set --enable-syslog-logging=true &amp;&amp; php bin/magento cache:flush  # enable\n</code></pre> <pre><code>php bin/magento setup:config:set --enable-syslog-logging=false &amp;&amp; php bin/magento cache:flush # disable\n</code></pre></p> <p>Database logging <pre><code>php bin/magento dev:query-log:enable &amp;&amp; php bin/magento cache:flush\n</code></pre> <pre><code>cat var/debug/db.log | less\n</code></pre> <pre><code>php bin/magento dev:query-log:disable &amp;&amp; php bin/magento cache:flush\n</code></pre></p>"},{"location":"magento-2/cron/","title":"Cron","text":"Bash Environment Configuration <p>~/.bashrc.d/env <pre><code>export PS1=\"\\[\\e[0;38;05;15m\\][\\[\\e[0;38;05;47m\\]\\u\\[\\e[0;38;05;15m\\]@\\[\\e[0;38;05;153m\\]\\h:\\[\\e[0;38;05;111m\\]\\w\\[\\e[0;38;05;15m\\]]\\\\$ \\[\\e[0m\\]\"\nalias m2-clean='rm -Rf generated/* var/cache/* var/page_cache/* var/di/* var/view_preprocessed/* pub/static/* &amp;&amp; redis-cli FLUSHALL'\nalias m2-cssclean=\"rm -Rf var/view_preprocessed/* &amp;&amp; find pub/static/ -name 'styles-*.css' -exec rm -f {} \\;\"\nalias m2-translation-clean=\"find pub/static/ -name 'js-transl*.*' -exec rm -f {} \\; &amp;&amp; php bin/magento cache:clean translate\"\n</code></pre> ~/.profile <pre><code>export PATH=\"$HOME/bin:$PATH\"\n</code></pre></p>"},{"location":"magento-2/cron/#run-cron-as-standalone-process","title":"Run cron as standalone process:","text":"<pre><code>php bin/magento cron:run --group=default --bootstrap=standaloneProcessStarted=1\n</code></pre>"},{"location":"magento-2/cron/#debug-cron-job","title":"Debug Cron Job","text":"<p><pre><code>TRUNCATE `cron_schedule`;\nINSERT INTO `cron_schedule` (`job_code`, `status`, `messages`, `created_at`, `scheduled_at`, `executed_at`, `finished_at`) VALUES\n('lengow_connector_launch_export', 'pending', NULL, NOW(), NOW(), NULL, NULL);\n</code></pre> <pre><code>php bin/magento cache:clean\nphp bin/magento cron:run --group=default --bootstrap=standaloneProcessStarted=1\n</code></pre></p>"},{"location":"magento-2/cron/#reindex-invalid-indexers-full-reindex-of-invalid-indexers","title":"Reindex invalid indexers (full reindex of invalid indexers)","text":"<p><pre><code>TRUNCATE `cron_schedule`;\nINSERT INTO `cron_schedule` (`job_code`, `status`, `messages`, `created_at`, `scheduled_at`, `executed_at`, `finished_at`) VALUES\n('indexer_reindex_all_invalid', 'pending', NULL, NOW(), NOW(), NULL, NULL);\n</code></pre> <pre><code>php bin/magento cron:run --group=index --bootstrap=standaloneProcessStarted=1\n</code></pre></p>"},{"location":"magento-2/cron/#reindex-of-subscribed-records-of-idle-indexers","title":"Reindex of subscribed records of idle indexers","text":"<p><pre><code>TRUNCATE `cron_schedule`;\nINSERT INTO `cron_schedule` (`job_code`, `status`, `messages`, `created_at`, `scheduled_at`, `executed_at`, `finished_at`) VALUES\n('indexer_update_all_views', 'pending', NULL, NOW(), NOW(), NULL, NULL);\n</code></pre> <pre><code>php bin/magento cron:run --group=index --bootstrap=standaloneProcessStarted=1\n</code></pre></p>"},{"location":"magento-2/cron/#statistics","title":"Statistics","text":"<pre><code>SELECT date(scheduled_at), \n    count(schedule_id) AS cnt, \n    SUM(IF(executed_at IS NULL, 0, 1)) as executed, \n    SUM(IF(finished_at IS NULL, 0, 1)) as finished\nFROM `cron_schedule`  \nGROUP BY date(scheduled_at)\nORDER BY `scheduled_at`  DESC;\n</code></pre>"},{"location":"magento-2/cron/#files","title":"Files","text":"<ol> <li><code>Magento\\Cron\\Observer\\ProcessCronQueueObserver::execute(Observer $observer)</code>(view)</li> <li><code>Magento\\Cron\\Observer\\ProcessCronQueueObserver::processPendingJobs($groupId, $jobsRoot, $currentTime)</code> (view)</li> </ol>"},{"location":"magento-2/db/","title":"DB","text":"<p>File: <pre><code>vendor/magento/zendframework1/library/Zend/Db/Adapter/Pdo/Abstract.php:223\n</code></pre></p> <p>Breakpoint: <pre><code>false !== strpos('' . $sql, 'cataloginventory_stock_item') &amp;&amp; false !== strpos('' . $sql, 'UPDATE')\n</code></pre></p> <p>Watch Query <pre><code>\\Magento\\Framework\\App\\ObjectManager::getInstance()-&gt;get(\\Magento\\Framework\\App\\ResourceConnection::class)-&gt;getConnection()-&gt;queryAll('SELECT * FROM `catalog_product`')\n</code></pre></p>"},{"location":"magento-2/install/","title":"Install","text":"Bash Environment Configuration <p>~/.bashrc.d/env <pre><code>export PS1=\"\\[\\e[0;38;05;15m\\][\\[\\e[0;38;05;47m\\]\\u\\[\\e[0;38;05;15m\\]@\\[\\e[0;38;05;153m\\]\\h:\\[\\e[0;38;05;111m\\]\\w\\[\\e[0;38;05;15m\\]]\\\\$ \\[\\e[0m\\]\"\nalias m2-clean='rm -Rf generated/* var/cache/* var/page_cache/* var/di/* var/view_preprocessed/* pub/static/* &amp;&amp; redis-cli FLUSHALL'\nalias m2-cssclean=\"rm -Rf var/view_preprocessed/* &amp;&amp; find pub/static/ -name 'styles-*.css' -exec rm -f {} \\;\"\nalias m2-translation-clean=\"find pub/static/ -name 'js-transl*.*' -exec rm -f {} \\; &amp;&amp; php bin/magento cache:clean translate\"\n</code></pre> ~/.profile <pre><code>export PATH=\"$HOME/bin:$PATH\"\n</code></pre></p>"},{"location":"magento-2/install/#create-magento-project","title":"Create Magento Project","text":"<p>Latest Magento version:</p> Magento Open SourceMagento CommerceMagento Cloud <pre><code>composer create-project --repository-url=https://repo.magento.com/ magento/project-community-edition mce24x\n</code></pre> <pre><code>composer create-project --repository-url=https://repo.magento.com/ magento/project-enterprise-edition mee24x\n</code></pre> <pre><code>composer create-project --repository-url=https://repo.magento.com/ magento/magento-cloud-metapackage mc24x\n</code></pre> <p>Specific Magento version:</p> Magento Open SourceMagento CommerceMagento Cloud <pre><code>composer create-project --repository-url=https://repo.magento.com/ magento/project-community-edition=2.4.0 mce240\n</code></pre> <pre><code>composer create-project --repository-url=https://repo.magento.com/ magento/project-enterprise-edition=2.4.0 mee240\n</code></pre> <pre><code>composer create-project --repository-url=https://repo.magento.com/ magento/magento-cloud-metapackage=2.4.0 mc240\n</code></pre> <p>Show available versions:</p> Magento Open SourceMagento CommerceMagento Cloud <pre><code>composer show magento/product-community-edition 2.4.* --all | grep -m 1 versions\n</code></pre> <pre><code>composer show magento/product-enterprise-edition 2.4.* --all | grep -m 1 versions\n</code></pre> <pre><code>composer show magento/magento-cloud-metapackage 2.4.* --all | grep -m 1 versions\n</code></pre>"},{"location":"magento-2/install/#install-magento-from-cli","title":"Install Magento from CLI","text":"<pre><code>php bin/magento setup:install \\\n    --use-rewrites=1 \\\n    --use-secure=1 \\\n    --base-url-secure=https://m24x.dev.local/ \\\n    --use-secure-admin=1 \\\n    --base-url=https://m24x.dev.local/ \\\n    --backend-frontname=admin \\\n    --db-name=m24x \\\n    --db-user=duser \\\n    --db-password=dpass \\\n    --session-save=files\n</code></pre>"},{"location":"magento-2/install/#add-administrator","title":"Add Administrator","text":"<pre><code>php bin/magento admin:user:create \\\n    --admin-user=admin \\\n    --admin-password=password \\\n    --admin-email=$USER@dev.local \\\n    --admin-firstname=Support \\\n    --admin-lastname=Account\n</code></pre>"},{"location":"magento-2/install/#disable-two-factor-authentication","title":"Disable Two factor Authentication","text":"<pre><code>php bin/magento module:disable Magento_TwoFactorAuth\nphp bin/magento setup:upgrade\n</code></pre>"},{"location":"magento-2/install/#upgrade-magento-project","title":"Upgrade Magento Project","text":"<pre><code>cp composer.json composer.json.bak\ncomposer require magento/product-community-edition 2.3.3 --no-update\ncomposer update\nphp bin/magento setup:upgrade\n</code></pre>"},{"location":"magento-2/layout/","title":"Layout","text":""},{"location":"magento-2/layout/#add-block-with-html-content","title":"Add block with html content","text":"<pre><code>&lt;referenceContainer name=\"content\"&gt;\n    &lt;block class=\"Magento\\Framework\\View\\Element\\Text\" name=\"my.block.name\"&gt;\n        &lt;arguments&gt;\n            &lt;argument translate=\"true\" name=\"text\" xsi:type=\"string\"&gt;\n                Lorem ipsum dolor ...\n            &lt;/argument&gt;\n        &lt;/arguments&gt;\n    &lt;/block&gt;\n&lt;/referenceContainer&gt;\n</code></pre>"},{"location":"magento-2/layout/#add-content-block-by-id","title":"Add content block by id","text":"<pre><code>&lt;referenceContainer name=\"content\"&gt;\n    &lt;block class=\"Magento\\Cms\\Block\\Block\" name=\"my.content.block\"&gt;\n        &lt;arguments&gt;\n            &lt;argument name=\"block_id\" xsi:type=\"string\"&gt;my-content-block-id&lt;/argument&gt;\n        &lt;/arguments&gt;\n    &lt;/block&gt;\n&lt;/referenceContainer&gt;\n</code></pre>"},{"location":"magento-2/layout/#add-block-to-page-head-section","title":"Add block to page head section","text":"<pre><code>&lt;referenceBlock name=\"head.additional\"&gt;\n    &lt;block class=\"Magento\\Framework\\View\\Element\\Text\" \n           name=\"my.block.name\" \n           template=\"Vendor_Module::template.phtml\" /&gt;\n&lt;/referenceBlock&gt;\n</code></pre>"},{"location":"magento-2/misc/","title":"Misc","text":"Bash Environment Configuration <p>~/.bashrc.d/env <pre><code>export PS1=\"\\[\\e[0;38;05;15m\\][\\[\\e[0;38;05;47m\\]\\u\\[\\e[0;38;05;15m\\]@\\[\\e[0;38;05;153m\\]\\h:\\[\\e[0;38;05;111m\\]\\w\\[\\e[0;38;05;15m\\]]\\\\$ \\[\\e[0m\\]\"\nalias m2-clean='rm -Rf generated/* var/cache/* var/page_cache/* var/di/* var/view_preprocessed/* pub/static/* &amp;&amp; redis-cli FLUSHALL'\nalias m2-cssclean=\"rm -Rf var/view_preprocessed/* &amp;&amp; find pub/static/ -name 'styles-*.css' -exec rm -f {} \\;\"\nalias m2-translation-clean=\"find pub/static/ -name 'js-transl*.*' -exec rm -f {} \\; &amp;&amp; php bin/magento cache:clean translate\"\n</code></pre> ~/.profile <pre><code>export PATH=\"$HOME/bin:$PATH\"\n</code></pre></p>"},{"location":"magento-2/misc/#phpstorm-urn","title":"PhpStorm Urn","text":"<ol> <li>container: <pre><code>php bin/magento dev:urn-catalog:generate .idea/misc.xml\n</code></pre></li> <li>host: <pre><code>sed -i \"s|/var/www/myproject|`pwd`|g\" .idea/misc.xml\n</code></pre></li> <li>PhpStorm: synchronize root directory &amp; wait 10 seconds.</li> </ol>"},{"location":"magento-2/misc/#create-module-package","title":"Create module package","text":"<p>For Marketplace:</p> <pre><code>git clone https://git.example.com/Vendor_Module.git\ncd Vendor_Module\nzip -r9 \"vendor-module-1.0.0.zip\" . -x *.git* *.idea*\n</code></pre> <p>Alternative way (archive will have a path app/code/Vendor/Module/):</p> <pre><code>zip -r9 \"vendor-module-1.0.0.zip\" app/code/Vendor/Module/ -x *.git*\n</code></pre>"},{"location":"magento-2/misc/#disable-event-programmatically","title":"Disable event programmatically","text":"<pre><code>use Magento\\Framework\\Event\\Config\\Data;\n\nclass Foo\n{\n    public function __construct(Data $eventConfigData) \n    {\n        $this-&gt;eventConfigData = $eventConfigData;\n    }\n\n    protected function disableEventObservers(string $event): void\n    {\n        $observers = $this-&gt;eventConfigData-&gt;get($event, []);\n        if ($observers) {\n            $observers = array_combine(array_keys($observers), array_fill(0, count($observers), ['disabled' =&gt; true]));\n            $this-&gt;eventConfigData-&gt;merge([$event =&gt; $observers]);\n        }\n    }\n}\n\n// usage: $this-&gt;disableEventObservers('sales_order_shipment_save_after');\n</code></pre>"},{"location":"magento-2/misc/#data-patch-development","title":"Data Patch Development","text":"<pre><code>mysql -e 'DELETE FROM patch_list WHERE patch_name = \"Vendor\\\\Module\\\\Setup\\\\Patch\\\\Data\\\\InitializeStoresAndWebsites\"' &amp;&amp; php bin/magento setup:upgrade\n</code></pre>"},{"location":"magento-2/misc/#recompile","title":"Recompile","text":"<pre><code>m2=\"php -d memory_limit=-1 bin/magento\" \\\n    &amp;&amp; $php bin/magento maintenance:enable \\\n    &amp;&amp; $php bin/magento cache:clean \\\n    &amp;&amp; rm -Rf generated/code/* var/cache/* var/page_cache/* var/di/* var/view_preprocessed/* pub/static/* \\\n    &amp;&amp; redis-cli FLUSHALL \\\n    &amp;&amp; $php bin/magento setup:di:compile \\\n    &amp;&amp; $php bin/magento setup:static-content:deploy -j 4 -t Vendor/default fr_FR en_US \\\n    &amp;&amp; $php bin/magento setup:static-content:deploy -j 4 -t Magento/backend fr_FR en_US \\\n    &amp;&amp; $php bin/magento maintenance:disable \\\n    &amp;&amp; sudo systemctl restart varnish\n</code></pre>"},{"location":"magento-2/misc/#well-known-validation-for-magento-cloud","title":"Well known validation (for Magento Cloud)","text":"<p>URL Example: <pre><code>https://example.com/.well-known/abc =&gt; https://example.com/media/.well-known/example.com/abc\n</code></pre></p> <p>Fastly Solution: <pre><code>if (req.url ~ \"/.well-known/\") {\n  set req.url = \"/media/.well-known/\" + req.http.host + regsub(req.url, \"\\/\\.well-known\\/\", \"/\");\n}\n</code></pre></p>"},{"location":"magento-2/misc/#bookmarks","title":"Bookmarks","text":"<ol> <li><code>I</code>:<code>\\Magento\\Framework\\Interception\\Interceptor::___callPlugins</code> - interceptor implementation</li> <li><code>E</code>:<code>\\Elasticsearch\\Connections\\Connection::wrapHandler:331</code> - catch elasticsearch request/response <pre><code>if (preg_match('/^{\"size\":[^0].*/', (string) $request['body'])) {\n   echo 'Request: '. $request['uri'] . PHP_EOL;\n   echo '&lt;style&gt;textarea {width:100%; height:45%}&lt;/style&gt;';\n   echo '&lt;textarea&gt;' . json_encode(json_decode($request['body'], true), JSON_PRETTY_PRINT) . '&lt;/textarea&gt;';\n   echo 'Response:&lt;textarea&gt;' . json_encode($response['body'], JSON_PRETTY_PRINT) . '&lt;/textarea&gt;';\n   exit;\n}\n</code></pre> 2.1.<code>\\Smile\\ElasticsuiteVirtualCategory\\Model\\Rule::getChildrenCategories</code></li> <li><code>M</code>:<code>\\Zend_Db_Adapter_Pdo_Abstract::query</code> - catch MySQL query <pre><code>static $handle;\nif (null === $handle) {\n   $handle = fopen(BP . '/var/log/sql.log', 'w+');\n}\nif ($handle) {\n   $message = 'SQL: ' . $sql . PHP_EOL;\n   if ($bind) {\n       $message .= 'BING: ' . print_r($bind, true) . PHP_EOL;\n   }\n   fwrite($handle, $message . PHP_EOL);\n}\n</code></pre> 3.1. <code>\\Magento\\Framework\\DB\\Adapter\\Pdo\\Mysql::prepareSqlCondition</code> - conditions map like 'lteq', 'gteq'</li> <li><code>P</code>:<code>\\Magento\\Catalog\\Pricing\\Price\\FinalPrice</code> - catalog final price </li> <li><code>R</code>:<code>\\Magento\\Framework\\HTTP\\PhpEnvironment\\Response::setHttpResponseCode</code> - show does redirect, set break point here to find out.</li> <li>pub/index.php - show XML layouts called for a current page <pre><code>$objectManager = \\Magento\\Framework\\App\\ObjectManager::getInstance();\n$xmlLayout = $objectManager-&gt;get(\\Magento\\Framework\\App\\View::class);\necho '&lt;pre&gt;';print_r($xmlLayout-&gt;getLayout()-&gt;getUpdate()-&gt;getHandles());\n</code></pre></li> </ol>"},{"location":"magento-2/misc/#useful-links","title":"Useful Links","text":"<ol> <li><code>Magento\\CatalogInventory\\Model\\StockStateProvider::checkQty(StockItemInterface $stockItem, $qty)</code> (view)</li> <li><code>Magento\\PageCache\\Observer\\FlushCacheByTags::execute(Observer $observer)</code> (view)</li> <li><code>Magento\\Framework\\App\\Request\\CsrfValidator</code> </li> <li>Quote<ul> <li><code>\\Magento\\Quote\\Model\\Quote\\Item\\Processor::prepare</code></li> <li><code>\\Magento\\Tax\\Model\\Sales\\Total\\Quote\\CommonTaxCollector::updateItemTaxInfo</code></li> </ul> </li> <li>Test or style the Order Success Page or how to stop Success Page redirecting</li> </ol>"},{"location":"magento-2/ng98/","title":"NG98","text":""},{"location":"magento-2/ng98/#installation","title":"Installation","text":"<p><pre><code>wget https://files.magerun.net/n98-magerun2.phar -O ~/bin/ng98     # ~/bin/ must be in $PATH\nchmod +x ~/bin/ng98\n</code></pre> more info: https://github.com/netz98/n98-magerun2</p>"},{"location":"magento-2/ng98/#usage","title":"Usage","text":"<pre><code>n98 config:store:get --decrypt path/a/b/c          # get and decrypt value\nn98 config:store:set --encrypt path/a/b/c value    # encrypt and set value\n</code></pre>"},{"location":"magento-2/ui/","title":"UI","text":""},{"location":"magento-2/ui/#m2js","title":"M2JS","text":"<p>Magento 2 UI custom debug functions: uii (ui info) and uiq (ui query).</p> <ol> <li>Install a Browser Plugin to include additional JS like User JavaScript and CSS </li> <li>Include external JS Library: https://yutv.github.io/kb/js/m2.js</li> <li>Open Developer Tools (F12), the following functions should be available: <pre><code>uiq(); // list of UI components on the page\nuii();  // information about UI Component\n</code></pre></li> </ol> <p>Usage Examples:</p> <ol> <li><code>uiq()</code> - show all ui components on the page.</li> <li><code>uiq('shipping-step')</code> - show ui components which have <code>shipping-step</code> in the name.</li> <li>Inspect a DOM Element using the Developer Tools (F12) and run the <code>uii()</code>. It will output information about knockout view model attached to the selected DOM element.</li> <li><code>uii('#my-element-id')</code> - show ko view model attached to the DOM element with given selector.</li> </ol>"},{"location":"magento-2/ui/#misc","title":"Misc","text":""},{"location":"magento-2/ui/#get-product-ids-from-a-category-page","title":"Get product IDs from a category page","text":"<pre><code>jQuery('.product-item-info').map(function (i, e) { return e.id.replace('product-item-info_', ''); }).toArray().join(',');\n</code></pre>"},{"location":"magento-2/ui/#show-knockout-model-associates-with-dom-node","title":"Show knockout model associates with DOM node","text":"<pre><code>require('ko').dataFor(document.querySelector('.totals.shipping.excl'));\n</code></pre>"},{"location":"magento-2/ui/#debug-when-shippingbilling-address-and-shipping-method-changed","title":"Debug when shipping/billing address and shipping method changed","text":"<pre><code>if (window.checkoutConfig) {\n    require(['Magento_Checkout/js/model/quote'], function(quote){\n        var getAddress = function (address) {\n            if (!address) {\n                return address;\n            }\n\n            var result = (!address.street) ? address.street : address.street[0];\n            result += ', ' + address.countryId;\n\n            return result;\n        }\n        quote.billingAddress.subscribe(function(address){\n            console.groupCollapsed('billingAddress: ' + getAddress(address));\n            console.info(address);\n            console.trace();\n            console.groupEnd();\n        });\n        quote.shippingAddress.subscribe(function(address){\n            console.groupCollapsed('shippingAddress: ' + getAddress(address));\n            console.info(address);\n            console.trace()\n            console.groupEnd();\n        });\n        quote.shippingMethod.subscribe(function(shippingMethod){\n            console.groupCollapsed('shippingMethod: ' + shippingMethod?.carrier_code + '_' + shippingMethod?.method_code);\n            console.info(shippingMethod);\n            console.trace();\n            console.groupEnd();\n        });\n    });\n}\n</code></pre>"},{"location":"magento-2/ui/#observe-dom-node-attribute-mutation","title":"Observe DOM Node Attribute Mutation","text":"<pre><code>window.addEventListener('DOMContentLoaded', () =&gt; {\n    const targetNode = document.querySelector('#payment_fr_express_checkout_other_express_checkout_required_enable_express_checkout');\n    if (!targetNode) {\n        return;\n    }\n    const config = { attributes: true, childList: true, subtree: true };\n    const callback = function(mutationsList, observer) {\n        for (let mutation of mutationsList) {\n            console.groupCollapsed('mutation[' + mutation.type + ']: ' + mutation.attributeName);\n            console.log(mutation);\n            console.trace()\n            console.groupEnd();\n        }\n    };\n    const observer = new MutationObserver(callback);\n    observer.observe(targetNode, config);\n});\n</code></pre>"},{"location":"magento-2/ui/#jquery-change-event-observer-position","title":"jQuery Change Event Observer Position","text":"<pre><code>var element = document.getElementById('#element'),\nelement.on('click', this.onClick.bind(this));       # add on click observer\nobserver = $._data(element, 'events').click.pop();  # remove the last observer\n$._data(element, 'events').click.unshift(observer); # insert it to the beginning \n</code></pre>"},{"location":"magento-2/ui/#show-message-on-early-stage","title":"Show message on early stage","text":"<pre><code>define([\n    'uiElement'\n], function (Element) {\n    'use strict';\n\n    return Element.extend({\n        defaults: {\n            msgError: 'Some error message',\n            modules: {\n                messages: 'messages'\n            }\n        },\n\n        initialize: function () {\n            this._super();\n            this.showError(this.msgError);\n        },\n\n        showError: function (text) {\n            this.messages(function (component) {\n                var data = component.messages();\n                data.messages = data.messages || [];\n                data.messages.push({ text: text, type: 'error' });\n                component.messages(data);\n            });\n        }\n    });\n});\n</code></pre>"},{"location":"magento-2/ui/#show-message-dynamically","title":"show message dynamically","text":"<pre><code>require('Magento_Customer/js/customer-data').get('messages')({messages: [{type: 'error', text: 'test message'}]});\n</code></pre>"},{"location":"magento-2/ui/#init-ui-component-dynamically","title":"init UI component dynamically","text":""},{"location":"magento-2/ui/#list-of-ui-components","title":"list of UI components","text":"<pre><code>require('uiRegistry').get((c, n) =&gt; console.log(n, c));\n</code></pre>"},{"location":"magento-2/ui/#jquery-validate","title":"jQuery Validate","text":""},{"location":"magento-2/ui/#custom-message","title":"custom message","text":"<p><pre><code>&lt;input type=\"text\" name=\"firstname\" data-validate='{\"required\":true}' data-msg-required=\"Please introduce yourself\"/&gt;\n</code></pre> Source: 1</p>"},{"location":"magento-2/ui/#files","title":"Files","text":"<ol> <li>mage/common.js on form submit automatically adds form_key input if missed.</li> <li>block-loader.js when use it with <code>jquery.validate.js</code> keep in mind it disables form fields. </li> </ol>"},{"location":"magento-2/ui/#loader-animation","title":"Loader Animation","text":"<ol> <li>mage/loader - shows a full screen loader</li> <li>ui/block-loader - shows a block loader e.g.: <code>data-bind=\"blockLoader: isLoading\"</code> </li> <li>show a block loader w/o UI components: <pre><code>ko.bindingHandlers.blockLoader.update(this.container.get(0), ko.observable(true));\n</code></pre></li> </ol>"},{"location":"magento-2/ui/#bind-html","title":"Bind HTML","text":"<p><pre><code>&lt;div data-bind=\"bindHtml: content\"&gt;&lt;/div&gt;\n</code></pre> <pre><code>&lt;div bindHtml=\"\n    &lt;div data-bind='text: \\'String from the text binding\\''&gt;&lt;/div&gt;\n\"&gt;&lt;/div&gt;\n</code></pre> Source: 1</p>"},{"location":"ubuntu/misc/","title":"Misc","text":""},{"location":"ubuntu/misc/#check-whether-the-x11-or-wayland-is-active","title":"Check whether the X11 or Wayland is active.","text":"<pre><code>echo $XDG_SESSION_TYPE\n</code></pre>"},{"location":"ubuntu/misc/#disable-wayland","title":"Disable Wayland","text":"<p><pre><code>sudo nano /etc/gdm3/custom.conf\n</code></pre> <pre><code>WaylandEnable=false\n</code></pre> <pre><code>restart\n</code></pre></p>"}]}